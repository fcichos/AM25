{
  "hash": "bff10a6f9a2a19ef5f69a52ba6f49d65",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Microscopic Models of Self-propulsion\"\njupyter: python3\nformat:\n  html:\n    toc: true\n    toc-location: right\ncrossref:\n  fig-title: Figure\n  tbl-title: Table\n  title-delim: \"—\"\n  fig-prefix: Figure\n  eq-prefix: Equation\n  chapters: true\n  fig-labels: arabic\n---\n\n\n\n## Introduction: From Equilibrium Violations to Microscopic Models\n\nIn the previous lecture, we explored the fundamental concepts of equilibrium statistical mechanics and how active biological systems violate these principles. We examined detailed balance and the fluctuation-dissipation theorem (FDT), discovering that active systems consistently break these equilibrium constraints.\n\nOne of the key examples we studied was sedimentation, where colloidal particles in thermal equilibrium form an exponential density profile according to the Boltzmann distribution:\n\n$$n(h) = n_0 e^{-\\frac{mgh}{k_B T}}$$\n\nThis distribution arises directly from equilibrium statistical mechanics and represents a balance between gravitational forces and thermal fluctuations.\n\nBut what happens when particles are active - consuming energy to propel themselves? This lecture begins by exploring one of the simplest active matter models: the run-and-tumble particle (RTP). We'll first examine this model in 1D with sedimentation to directly contrast with our equilibrium example from lecture 2, demonstrating how active particles violate equilibrium principles even in this simplified scenario.\n\nFrom there, we'll extend to more sophisticated microscopic models that can capture the essential features of self-propelled particles in three dimensions:\n\n1. **Run-and-Tumble Particles (RTPs)** - inspired by bacterial motion patterns like E. coli\n2. **Active Brownian Particles (ABPs)** - which combine random diffusion with persistent self-propulsion\n3. **Swimming at Low Reynolds Number** - examining the physics that governs locomotion at the microscale\n4. **Hydrodynamic Interactions** - understanding how active particles influence their surroundings and each other\n5. **Microswimmer Force Dipoles** - characterizing the flow fields generated by different types of swimmers\n\nThese models will provide us with the tools to analyze collective behaviors, pattern formation, and non-equilibrium dynamics in active biological systems.\n\n\n## Run-and-Tumble Particles (RTPs)\n\nRun-and-tumble dynamics represent an important class of active motion, inspired by the swimming behavior of bacteria like E. coli. Unlike passive Brownian motion, run-and-tumble particles alternate between straight-line \"runs\" and random reorientation \"tumbles.\"\n\n::: {.content-visible unless-format=\"pdf\"}\n::: {#fig-bacteria}\n![](/assets/movies/lecture03/p_tai_5_perc_PEG_0_9mW_laser_assembly_take1_001_video.mp4)\n\nRun-and-reverse motion of Pseudomonas Taiwanensis bacteria (move by Desmond Quinn, MONA group).\n:::\n:::\n\nThis run-and-tumble motion, which comes in different flavors (e.g. a run-and revserse motion as displayed in the movie above) has even some functionality. It allows bacteria to move in gradients of chemical species concentrations without measuring even the gradient directly.\n\n\n### 1D Run-and-Tumble with Sedimentation\n\nWe can make a simple model for this run-and-tumble motion in one dimension. Let's start with the master equations for the probabilities $P_+(x,t)$ and $P_-(x,t)$ of finding a particle at position $x$ moving in the positive or negative direction, respectively. In the simplest case without gravity or diffusion:\n\n$$\\frac{\\partial P_+}{\\partial t} = -\\frac{\\partial}{\\partial x}(v_0(x)P_+) - \\lambda P_+ + \\lambda P_-$$\n\n$$\\frac{\\partial P_-}{\\partial t} = \\frac{\\partial}{\\partial x}(v_0(x)P_-) + \\lambda P_+ - \\lambda P_-$$\n\nThese equations describe how probabilities change due to advection at position-dependent speed $v_0(x)$ and flipping of the swimming direction with rate $\\lambda$.\n\nWe can rewrite these equations in terms of the total probability density $P(x,t) = P_+(x,t) + P_-(x,t)$ and the polarization $\\sigma(x,t) = P_+(x,t) - P_-(x,t)$. After adding and subtracting the equations:\n\n$$\\frac{\\partial P}{\\partial t} = -\\frac{\\partial}{\\partial x}(v_0(x)\\sigma)$$\n\n$$\\frac{\\partial \\sigma}{\\partial t} = -\\frac{\\partial}{\\partial x}(v_0(x)P) - 2\\lambda \\sigma$$\n\n:::{.callout-note collapse=true}\nFrom the first equation, we can identify the probability current as $J(x,t) = v_0(x) \\sigma(x,t)$. In the steady state, $\\frac{\\partial \\sigma}{\\partial t} = 0$, which gives:\n\n$$\\frac{\\partial}{\\partial x}(v_0(x)P) = -2\\lambda \\sigma$$\n\n$$v_0(x)\\frac{\\partial P}{\\partial x} + P\\frac{dv_0(x)}{dx} = -2\\lambda \\sigma$$\n\nSolving for $\\sigma$:\n\n$$\\sigma(x) = -\\frac{v_0(x)}{2\\lambda}\\frac{\\partial P}{\\partial x} - \\frac{P}{2\\lambda}\\frac{dv_0(x)}{dx}$$\n:::\n\nThis then yields the current:\n\n$$J(x) = v_0(x) \\sigma(x) = -\\frac{v_0^2(x)}{2\\lambda}\\frac{\\partial P}{\\partial x} - \\frac{v_0(x)P}{2\\lambda}\\frac{dv_0(x)}{dx}$$\n\nThis has the form of a drift-diffusion current $J = -D_{\\text{eff}}\\frac{\\partial P}{\\partial x} + V_{\\text{eff}}P$ with a position-dependent effective diffusion coefficient $D_{\\text{eff}}(x) = \\frac{v_0^2(x)}{2\\lambda}$ and an effective drift velocity $V_{\\text{eff}}(x) = -\\frac{v_0(x)}{2\\lambda}\\frac{dv_0(x)}{dx}$.\n\n#### Density Distributions in Different Regimes\n\nOne can find out now the steady state distribution of run-and-tumble swimmers for different cases. Two interesting ones  are:\n\n1) **Position-dependent tumble rate, constant speed**:\nWhen the speed $v_0$ is constant but the tumble rate $\\lambda(x)$ varies with position, the steady-state current is:\n\n$$J(x) = -\\frac{v_0^2}{2\\lambda(x)}\\frac{\\partial P}{\\partial x}$$\n\nSetting J(x) = 0 for the steady state yields:\n\n$$\\frac{\\partial P}{\\partial x} = 0$$\n\nThis gives a uniform density distribution:\n\n$$P(x) = \\text{constant}$$\n\nInterestingly, spatial variation in tumble rate alone ($\\lambda(x)$) cannot create population gradients when the swimming speed is constant. However, in bacterial chemotaxis, the tumble rate depends not just on position but also on the bacterium's orientation relative to the chemical gradient: $\\lambda(\\mathbf{r}, \\mathbf{n}) = \\lambda_0(1 - \\mathbf{n} \\cdot \\nabla c(\\mathbf{r})/|\\nabla c(\\mathbf{r})|)$. This directional dependence allows bacteria to effectively navigate chemical landscapes, creating population gradients despite constant swimming speed. (see for example [1](https://www.pnas.org/doi/10.1073/pnas.1816315116))\n\n:::{.callout-note}\n# Chemotaxis\n\nChemotaxis is the directed movement of organisms in response to chemical gradients in their environment. This behavior allows cells to move toward favorable chemical conditions (positive chemotaxis) or away from harmful ones (negative chemotaxis). In bacteria like E. coli, chemotaxis works through a biased random walk: rather than directly sensing gradient directions, bacteria adjust their tumbling frequency based on whether they're moving toward or away from attractive chemicals. This elegant mechanism enables even simple single-celled organisms to effectively navigate complex chemical landscapes without sophisticated sensory apparatus.\n:::\n\n2) **Position-dependent speed, constant tumble rate**:\nWhen the swimming speed depends on position $v_0(x)$ while the tumble rate $\\lambda$ remains constant, we can find the steady-state density distribution by setting $J(x) = 0$ (no flux condition) and solving:\n\n$$-\\frac{v_0^2(x)}{2\\lambda}\\frac{\\partial P}{\\partial x} - \\frac{v_0(x)P}{2\\lambda}\\frac{dv_0(x)}{dx} = 0$$\n\nThis simplifies to:\n\n$$\\frac{\\partial P}{\\partial x} = -\\frac{1}{v_0(x)}\\frac{dv_0(x)}{dx}P$$\n\nThe solution gives the steady-state density distribution:\n\n$$P(x) \\propto \\frac{1}{v_0(x)}$$\n\nThis reveals that bacteria naturally accumulate in regions of lower swimming speed. Looking at the effective drift velocity $V_{\\text{eff}}(x) = -\\frac{v_0(x)}{2\\lambda}\\frac{dv_0(x)}{dx} = -\\frac{1}{4\\lambda}\\frac{d(v_0^2(x))}{dx}$, we see bacteria will move toward regions where swimming speed decreases. This provides a mechanism for chemotaxis without directly modulating the tumbling rate. In fact this overwrites the detailed balance equation we obtained earlier for equilibrium.\n\n\n\n#### Sedimentation of Run-and-tumeble particles\nWith a little bit of effort, one can modify this simple model to include an additional sedimentation drift velocity which is given by $mg/\\gamma$, where $\\gamma$ is the friction coefficient. Including further thermal diffusion yields:\n\n$$\\frac{\\partial P_+}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left[(v_0(x)-\\frac{mg}{\\gamma})P_+\\right] - \\lambda P_+ + \\lambda P_- + D\\frac{\\partial^2 P_+}{\\partial x^2}$$\n\n$$\\frac{\\partial P_-}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left[(-v_0(x)-\\frac{mg}{\\gamma})P_-\\right] + \\lambda P_+ - \\lambda P_- + D\\frac{\\partial^2 P_-}{\\partial x^2}$$\n\nIn the steady state, when thermal diffusion is small ($D \\approx 0$), we obtain:\n\n$$P(x) = P_+(x) + P_-(x) \\propto e^{-\\frac{x}{\\delta}}$$\n\nwhere $\\delta$ is the sedimentation length\n\n$$\\delta = \\frac{v_0^2-(mg/\\gamma)^2}{2\\lambda mg/\\gamma}$$\n\nThis is strikingly different from the equilibrium result! When sedimentation speed and active particle speed are comparable the sedimentation length is zero. The bacteria would completely collapse to a layer on the surface.\n\nIf the speed is now bigger than the sedimentation speed, the sedimentation length becomes positive.\n\nSince the sedimentation length in equilibrium is\n\n$$\\delta = \\frac{k_B T}{mg}$$\n\nit is tempting to say that\n\n$$\\frac{k_B T_\\mathrm{eff}}{mg}=\\frac{v_0^2-(mg/\\gamma)^2}{2\\lambda mg/\\gamma}$$\n\nwhich yields an effective temperature\n\n$$T_\\mathrm{eff} = \\frac{v_0^2-(mg/\\gamma)^2}{2\\lambda k_B}$$\n\nwhich is not the temperature of the surrounding medium. This effective temperature accounts for the active motion of the particle and its interaction with the surrounding medium.\n\n::: {#cell-fig-sedimentation .cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\"}\n# Parameters\nx = np.linspace(0, 10, 1000)  # height above surface\nv_sed = 1                    # sedimentation velocity mg/γ\nlambda_tumble = 0.6            # tumble rate\n\n# Three different active velocities\nv0_values = [1.01, 2, 3]       # self-propulsion speeds\n\n# Calculate density profiles\nplt.figure(figsize=get_size(10, 8))\n\nfor v0 in v0_values:\n    # Calculate sedimentation length\n    delta = (v0**2 - v_sed**2) / (2 * lambda_tumble * v_sed)\n\n    density = np.exp(-x / delta)\n\n    density = density / density[0]\n\n    plt.plot(x, density, '-', linewidth=1, label=f'$v_0 = {v0}$')\n\nplt.xlabel('height $z$')\nplt.ylabel('$P(x)/P(0)$')\nplt.legend()\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Sedimentation profiles for three different activity levels. As the speed $v_0$ increases relative to the sedimentation velocity $mg/γ=1$, the density profile extends further from the bottom surface.](lecture03_files/figure-html/fig-sedimentation-output-1.png){#fig-sedimentation width=573 height=457}\n:::\n:::\n\n\n### Mathematical Formulation in Higher Dimensions\nExtending to higher dimensions, the equations of motion for a run-and-tumble particle can be written as:\n\n$$\\frac{d\\mathbf{r}}{dt} = v_0 \\mathbf{n}(t) - \\frac{1}{\\gamma}\\nabla U(\\mathbf{r}) + \\boldsymbol{\\xi}(t)/\\gamma$$\n\nwhere $\\mathbf{n}(t)$ represents the orientation vector that changes discontinuously according to a Poisson process. This stochastic process models tumbling events as memory-less, random occurrences with the fundamental property:\n\n$$P(\\text{tumble in interval } [t, t+dt]) = \\lambda \\, dt + o(dt)$$\n\nwhere $\\lambda$ is the tumbling rate and $o(dt)$ represents higher-order terms that become negligible for small $dt$. This formulation has several important implications:\n\n1. The probability of a tumble occurring in any small time interval $dt$ is proportional to the length of that interval, with $\\lambda$ being the proportionality constant.\n\n2. Tumbling events are statistically independent - the probability of a tumble occurring is unaffected by when the previous tumble occurred, giving the process its \"memory-less\" property.\n\n3. The waiting times between consecutive tumbles follow an exponential distribution with mean $1/\\lambda$:\n   $$P(\\text{time between tumbles} > \\tau) = e^{-\\lambda\\tau}$$\n\n4. The number of tumbles $N(t)$ occurring within a time interval $[0, t]$ follows a Poisson distribution:\n   $$P(N(t) = k) = \\frac{(\\lambda t)^k e^{-\\lambda t}}{k!}$$\n\nA critical aspect of the run-and-tumble model is how the new orientation is determined after each tumbling event. In the standard model, the new orientation vector $\\mathbf{n}(t^+)$ immediately after a tumble at time $t$ is chosen from a uniform probability distribution on the unit circle (in 2D) or sphere (in 3D), completely independent of the previous orientation $\\mathbf{n}(t^-)$. This means:\n\n- In 2D: The new angle $\\theta_{new}$ is drawn uniformly from $[0, 2\\pi)$\n- In 3D: The new direction is uniformly distributed on the unit sphere, typically generated by choosing $\\phi$ uniformly from $[0, 2\\pi)$ and $\\cos\\theta$ uniformly from $[-1, 1]$\n\nThis uniform reorientation distribution is a key feature that distinguishes run-and-tumble motion from other active particle models. For some biological swimmers, variations of this distribution may be more appropriate - for example, some bacteria exhibit a \"persistence\" in their tumbling, where the new direction maintains some correlation with the previous direction. Other organisms might show \"run-and-reverse\" behavior, where the new orientation is preferentially opposite to the previous one. These variations can be modeled by modifying the reorientation distribution accordingly.\n\n::: {#cell-fig-run-tumble-2d .cell execution_count=3}\n``` {.python .cell-code code-fold=\"true\"}\n# Parameters for run-and-tumble motion\nv0 = 1.0            # speed (constant)\nlambda_tumble = 0.4  # tumble rate\ntotal_time = 50      # total simulation time\ndt = 0.1            # time step\n\n# Function to generate a single run-and-tumble trajectory\ndef simulate_run_tumble_2d(v0, lambda_tumble, total_time, dt, seed=None):\n    if seed is not None:\n        np.random.seed(seed)\n\n    # Number of time steps\n    n_steps = int(total_time / dt)\n\n    # Initialize arrays for position and orientation\n    x = np.zeros(n_steps)\n    y = np.zeros(n_steps)\n    theta = np.zeros(n_steps)\n\n    # Set random initial orientation\n    theta[0] = 2 * np.pi * np.random.random()\n\n    # Simulate run-and-tumble motion\n    for i in range(1, n_steps):\n        # Check if tumble occurs (Poisson process)\n        if np.random.random() < lambda_tumble * dt:\n            # New random orientation\n            theta[i] = 2 * np.pi * np.random.random()\n        else:\n            # Keep same orientation\n            theta[i] = theta[i-1]\n\n        # Update position\n        x[i] = x[i-1] + v0 * np.cos(theta[i]) * dt\n        y[i] = y[i-1] + v0 * np.sin(theta[i]) * dt\n\n    return x, y\n\n# Create figure\nplt.figure(figsize=get_size(10, 10))\n\n# Generate and plot 10 trajectories\nfor i in range(10):\n    x, y = simulate_run_tumble_2d(v0, lambda_tumble, total_time, dt, seed=i)\n    plt.plot(x, y, '-', linewidth=1, alpha=0.7)\n\n# Add marker for starting point\nplt.scatter(0, 0, color='red', s=50)\n\nplt.xlabel('x')\nplt.ylabel('y')\nplt.axis('equal')\nplt.grid(True, linestyle='--', alpha=0.3)\nplt.xlim(-15, 15)\nplt.ylim(-15, 15)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Ten trajectories of run-and-tumble particles in 2D, each starting from the origin. The particles move with constant speed v₀ = 1 and randomly change direction according to a Poisson process with rate λ = 0.1.](lecture03_files/figure-html/fig-run-tumble-2d-output-1.png){#fig-run-tumble-2d width=576 height=569}\n:::\n:::\n\n\n### Connection to ABPs\n\nInterestingly, in the limit of long observation times, the large-scale dynamics of RTPs become equivalent to those of ABPs. The effective rotational diffusion coefficient for RTPs is:\n\n$$D_r^{\\text{eff}} = \\frac{\\lambda}{d-1}$$\n\nwhere $d$ is the dimensionality. This equivalence suggests that these seemingly different microscopic mechanisms can lead to similar macroscopic behaviors.\n\n### Non-equilibrium Aspects\n\nRTP models demonstrate several non-equilibrium features beyond the effective temperature we observed in sedimentation:\n\n1. The steady-state cannot be written as a Boltzmann distribution\n2. Probability currents exist even in steady state\n3. The fluctuation-dissipation theorem is violated\n\nThese features arise from the persistent energy consumption required to maintain the run-and-tumble motion.\n\n\n## Active Brownian Particles (ABPs)\nAfter examining Run-and-Tumble Particles, we now turn to Active Brownian Particles (ABPs), which represent another fundamental model of self-propelled agents. Like RTPs, ABPs extend the equilibrium Brownian motion framework we discussed in Lecture 2, but they do so through continuous rotational diffusion rather than discrete tumbling events. This alternative self-propulsion mechanism similarly drives the system out of equilibrium.\n\n::: {.content-visible unless-format=\"pdf\"}\n::: {#fig-janus}\n![](/assets/movies/lecture03/JP_Fe_wf_2_81_slm075_292_video.mov)\n\nJanus particles performing active Brownian motion. These synthetic microswimmers have two distinct faces with different chemical or physical properties, causing them to self-propel through an asymmetric interaction with their environment while undergoing rotational diffusion. The movie contains not only ABP motion but some additional driving force. (Movie by Lisa Rohde, MONA group.)\n:::\n:::\n\n\n### Mathematical Formulation\n\nTo understand Active Brownian Particles, we should start from the general underdamped Langevin equation for Brownian motion:\n\n$$m\\frac{d^2\\mathbf{r}}{dt^2} = \\underbrace{-\\gamma\\frac{d\\mathbf{r}}{dt}}_{\\text{sink}} - \\nabla U(\\mathbf{r}) + \\underbrace{\\boldsymbol{\\xi}(t)}_{\\text{source}}$$\n\nHere, $\\mathbf{r}=(x,y)$ is the particle position, $m$ is the particle mass, and the left side represents inertial forces. On the right side we have a dissipative friction term with coefficient $\\gamma$ that removes energy from the system, a conservative force from the potential $U(\\mathbf{r})$, and a thermal noise term $\\boldsymbol{\\xi}(t)$ that injects energy into the particle motion. The thermal translational noise $\\boldsymbol{\\xi}(t)$ has zero mean ($\\langle\\boldsymbol{\\xi}(t)\\rangle = 0$) and correlations $\\langle\\xi_i(t)\\xi_j(t')\\rangle = 2\\gamma k_B T \\delta_{ij}\\delta(t-t')$, following the fluctuation-dissipation theorem.\n\nThe energy dissipation rate due to friction is given by $P_{diss} = \\gamma|\\mathbf{v}|^2$, where $\\mathbf{v}=\\frac{d\\mathbf{r}}{dt}$ is the particle velocity. In equilibrium, the average energy dissipation rate per degree of freedom is $\\langle P_{diss} \\rangle = \\frac{2\\gamma k_B T}{m}$. Meanwhile, the energy injection rate from thermal fluctuations can be calculated from the work done by the random force: $P_{inj} = \\boldsymbol{\\xi}(t) \\cdot \\mathbf{v}$.\n\nTo determine the average injected power, we need to evaluate $\\langle \\boldsymbol{\\xi}(t) \\cdot \\mathbf{v} \\rangle$. This requires examining the correlation between the noise and velocity, which isn't immediately obvious since both are stochastic quantities. We can solve this by considering the Langevin equation in the stationary state. From the equipartition theorem, we know that $\\langle mv^2 \\rangle = k_B T$ per degree of freedom, which means $\\langle v^2 \\rangle = \\frac{k_B T}{m}$.\n\nThe instantaneous velocity can be formally expressed using the Green's function solution of the Langevin equation:\n\n$$\\mathbf{v}(t) = \\frac{1}{\\gamma}\\int_{-\\infty}^{t} \\boldsymbol{\\xi}(t') e^{-(t-t')/\\tau_p} dt'$$\n\nwhere $\\tau_p = m/\\gamma$ is the momentum relaxation time. Using this expression and the noise correlation function $\\langle \\xi_i(t) \\xi_j(t') \\rangle = 2\\gamma k_B T \\delta_{ij}\\delta(t-t')$, we can calculate:\n\n\\begin{eqnarray}\n\\langle \\boldsymbol{\\xi}(t) \\cdot \\mathbf{v}(t) \\rangle &= \\frac{1}{\\gamma}\\sum_i\\int_{-\\infty}^{t} \\langle \\xi_i(t)\\xi_i(t') \\rangle e^{-(t-t')/\\tau_p} dt' \\\\\n&= \\frac{2\\gamma k_B T}{\\gamma} \\int_{-\\infty}^{t} \\delta(t-t') e^{-(t-t')/\\tau_p} dt' = \\frac{2\\gamma k_B T}{m} \\tau_p = \\frac{2\\gamma k_B T}{m}\n\\end{eqnarray}\n\nThus, the average energy injection rate per degree of freedom is $\\langle P_{inj} \\rangle = \\frac{2\\gamma k_B T}{m}$. The equality between injection and dissipation rates ensures detailed balance in equilibrium systems, maintaining a consistent average kinetic energy of $\\frac{k_B T}{2}$ per degree of freedom in accordance with the equipartition theorem.\n\nFor microscopic particles in a viscous medium, the inertial term becomes negligible (mass effects disappear on timescales $t \\gg m/\\gamma$), leading to the overdamped limit.\n\nIn an ABP, we add a non-equilibrium self-propulsion force, resulting in these overdamped Langevin equations:\n\n$$\\gamma\\frac{d\\mathbf{r}}{dt} = \\gamma v_0 \\mathbf{n}(t) - \\nabla U(\\mathbf{r}) + \\boldsymbol{\\xi}(t)$$\n\n$$\\frac{d\\theta}{dt} = \\eta(t)$$\n\nThe first equation describes the particle's translational motion, where $v_0$ is the self-propulsion speed and $\\mathbf{n}(t) = (\\cos\\theta(t), \\sin\\theta(t))$ is a unit vector pointing in the direction of self-propulsion.\n\nThe second equation governs the particle's orientation $\\theta$, which evolves through rotational diffusion. The rotational noise $\\eta(t)$ has zero mean ($\\langle\\eta(t)\\rangle = 0$) and correlations $\\langle\\eta(t)\\eta(t')\\rangle = 2D_r\\delta(t-t')$, where $D_r$ is the rotational diffusion coefficient.\n\nUnlike passive Brownian motion discussed in Lecture 2, ABPs fundamentally violate detailed balance due to the persistent self-propulsion term, which acts as an additional energy source driving the system out of equilibrium. The particle moves with a characteristic persistence time $\\tau_r = 1/D_r$ before its direction is randomized by rotational diffusion.\n\n\n### Mean Displacement\n\nIf we consider an active Brownian particle in two dimension starting at the origin (x=0, y=0) with an initial orientation θ=0 (pointing along the positive x-axis), the mean displacement shows interesting directional behavior:\n\n$$\\langle x(t) \\rangle = \\frac{v_0}{D_r}(1-e^{-D_r t})$$\n\n$$\\langle y(t) \\rangle = 0$$\n\nThe mean displacement in the y-direction averages to zero due to the symmetry of rotational diffusion. The x-component shows an initial ballistic growth that saturates at the persistence length scale $l_p=v_0/D_r$ for times much larger than the rotational diffusion time $\\tau_r=1/D_r$. This persistence length represents the typical distance traveled before the particle's direction is randomized.\n\nUnlike equilibrium Brownian motion where the mean displacement is zero in all directions, the ABP's mean displacement reflects the persistence of its self-propulsion. As $t \\to \\infty$, the orientation becomes fully randomized, and any further displacement averages to zero, resulting in the saturation of the mean displacement to a finite value.\n\n::: {#cell-fig-traj1 .cell execution_count=4}\n\n::: {.cell-output .cell-output-display}\n![Trajectories of a particle (R=1 µm) starting at the origin with an initial orientation $\\theta=0$. Left: passive Brownian particle ($v=0$ µm/s). Right: Active Brownian Particle ($v=10$ µm/s). ($\\tau_r=6 s$.)](lecture03_files/figure-html/fig-traj1-output-1.png){#fig-traj1 width=692 height=339}\n:::\n:::\n\n\n### Mean Square Displacement\n\nThe mean square displacement (MSD) of an ABP reveals a rich multi-regime behavior that can be analyzed from the full expression:\n\n$$\\langle|\\mathbf{r}(t) - \\mathbf{r}(0)|^2\\rangle = 4D_t t + \\frac{2v_0^2}{D_r^2}(D_r t - 1 + e^{-D_r t})$$\n\nwhere $D_t = k_BT/\\gamma$ is the thermal translational diffusion coefficient.\n\nWe can identify three distinct regimes by examining the limiting behavior at different timescales:\n\n1. **Very short times** ($t \\ll\\tau_r$, where $\\tau_r = 1/D_r$ is the rotational diffusion time):\n\nBy expanding the exponential term $e^{-D_r t} \\approx 1 - D_r t + \\frac{(D_r t)^2}{2} - ...$, we obtain:\n\n$$\\langle|\\mathbf{r}(t) - \\mathbf{r}(0)|^2\\rangle \\approx 4D_t t + v_0^2 t^2 + ...$$\n\nThis reveals a combination of diffusive behavior ($\\sim t$) from thermal fluctuations and the beginning of ballistic motion ($\\sim t^2$) from persistent self-propulsion.\n\n2. **Intermediate times** ($\\tau_t \\ll t \\ll \\tau_r$):\n\nThe ballistic term dominates and the MSD scales approximately as:\n\n$$\\langle|\\mathbf{r}(t) - \\mathbf{r}(0)|^2\\rangle \\approx v_0^2 t^2$$\n\nThis quadratic scaling reflects the persistent directed motion before rotational diffusion randomizes the swimming direction.\n\n3. **Long times** ($t \\gg \\tau_r$):\n\nWhen $t \\gg 1/D_r$, $e^{-D_r t} \\approx 0$, and the MSD becomes:\n\n$$\\langle|\\mathbf{r}(t) - \\mathbf{r}(0)|^2\\rangle \\approx 4D_t t + \\frac{2v_0^2}{D_r}t - \\frac{2v_0^2}{D_r^2}$$\n\nFor sufficiently long times, the constant term becomes negligible, resulting in diffusive motion with an enhanced effective diffusion coefficient:\n\n$$D_{\\text{eff}} = D_t + \\frac{v_0^2}{2dD_r}$$\n\nwhere $d$ is the dimensionality. This enhanced diffusion coefficient represents a key signature of the system's non-equilibrium nature and cannot be explained by equilibrium statistical mechanics.\n\n::: {#cell-fig-msd .cell execution_count=5}\n``` {.python .cell-code code-fold=\"true\"}\n# Parameters\nD_t = 1.0      # thermal translational diffusion coefficient\nv_0 = 5.0      # self-propulsion speed\nD_r = 0.2      # rotational diffusion coefficient\ntau_r = 1/D_r  # rotational diffusion time\n\n# Calculate theoretical MSD\ndef msd_theory(t, D_t, v_0, D_r):\n    \"\"\"Theoretical mean square displacement for active Brownian particles\"\"\"\n    return 4*D_t*t + (2*v_0**2)/(D_r**2)*(D_r*t - 1 + np.exp(-D_r*t))\n\n# Time range spanning multiple regimes\nt = np.logspace(-2, 2, 1000)  # from 0.01 to 100\nmsd = msd_theory(t, D_t, v_0, D_r)\n\n# Calculate effective diffusion coefficient\nD_eff = D_t + v_0**2/(2*D_r)\n\n# Create figure\nplt.figure(figsize=get_size(10, 8))\n\n# Plot MSD on log-log scale\nplt.loglog(t, msd, 'b-', linewidth=2, label='MSD of ABP')\n\n# Add reference lines for different scaling regimes\nt_ref = np.array([0.05, 50])\nplt.loglog(t_ref, 4*D_t*t_ref, 'k--', label=r'$\\sim 4D_t t$ (thermal diffusion)')\nplt.loglog(t_ref, v_0**2*t_ref**2, 'r--', label=r'$\\sim v_0^2 t^2$ (ballistic)')\nplt.loglog(t_ref, 4*D_eff*t_ref, 'g--', label=r'$\\sim 4D_{eff}t$ (enhanced diffusion)')\n\n# Add vertical line at rotational diffusion time\nplt.axvline(x=tau_r, color='gray', linestyle=':', label=r'$\\tau_r = 1/D_r$')\n\n# Mark the three regimes\n#plt.annotate(\"Short-time regime\", xy=(0.02, 0.3), xytext=(0.02, 0.3), fontsize=9)\n#plt.annotate(\"Intermediate-time regime\", xy=(0.5, 10), xytext=(0.5, 10), fontsize=9)\n#plt.annotate(\"Long-time regime\", xy=(10, 200), xytext=(10, 200), fontsize=9)\n\nplt.xlabel(r'Time $t$')\nplt.ylabel(r'MSD $\\langle|\\mathbf{r}(t) - \\mathbf{r}(0)|^2\\rangle$')\n#plt.legend()\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Mean square displacement (MSD) of an active Brownian particle showing three distinct regimes. At short times ($t \\ll \\tau_r$), a combination of diffusive and ballistic motion is observed. At intermediate times, ballistic motion dominates ($\\text{MSD} \\sim t^2$). At long times ($t \\gg \\tau_r$), enhanced diffusion emerges with an effective diffusion coefficient larger than the thermal value.](lecture03_files/figure-html/fig-msd-output-1.png){#fig-msd width=570 height=452}\n:::\n:::\n\n\n### Probability Distribution\n\nThe steady-state probability distribution of ABPs cannot be written in the Boltzmann form, unlike equilibrium systems. Instead, it depends on both position and orientation, and generally has to be obtained numerically or through approximation methods.\n\nIn homogeneous space, the orientation-averaged probability distribution is uniform. However, in the presence of boundaries or spatially varying potentials, ABPs exhibit phenomena like accumulation at surfaces and trapping in local potential minima that are qualitatively different from equilibrium Brownian particles.\n\n### Time Reversal Symmetry Breaking\n\nOne of the hallmarks of equilibrium systems is their invariance under time reversal. For passive Brownian particles, if we were to watch a movie of particle motion and then play it backwards, the reversed trajectories would still be physically plausible and consistent with the laws of equilibrium statistical mechanics.\n\nFor ABPs, however, time reversal symmetry is explicitly broken. This can be seen directly from the overdamped Langevin equations:\n\n$$\\gamma\\frac{d\\mathbf{r}}{dt} = \\gamma v_0 \\mathbf{n}(t) - \\nabla U(\\mathbf{r}) + \\boldsymbol{\\xi}(t)$$\n\n$$\\frac{d\\theta}{dt} = \\eta(t)$$\nUnder time reversal $t \\rightarrow -t$, the position derivative transforms as $\\frac{d\\mathbf{r}}{d(-t)} = -\\frac{d\\mathbf{r}}{dt}$, meaning the left side of the equation changes sign. The random noise term $\\boldsymbol{\\xi}(-t)$ remains statistically equivalent to $\\boldsymbol{\\xi}(t)$ due to its time-symmetric properties. However, the self-propulsion term $v_0 \\mathbf{n}(t)$ behaves differently: while the orientation vector $\\mathbf{n}(t)$ would evolve backwards in time, the self-propulsion speed $v_0$ maintains its sign because it represents an internal energy conversion process (chemical to mechanical) with a fixed directionality relative to the particle's orientation. This non-reversing active driving force is fundamentally different from reversible conservative forces, as it continually injects energy into the system. Consequently, the original equation and its time-reversed version describe physically distinct dynamics, demonstrating explicit time-reversal symmetry breaking in active systems.\n\n::: {#fig-trs}\n![](/assets/images/lecture03/JP_TRS.png){width=50%}\n\nJanus particles exhibit physical asymmetry, with different properties on their two faces. This structural asymmetry leads to directional self-propulsion and breaking of time-reversal symmetry. The asymmetric design of Janus particles (e.g., with one catalytic hemisphere) creates directed motion that fundamentally breaks time-reversal symmetry. Under time reversal, the particle would appear to move against its catalytic face—a physically impossible scenario that illustrates the non-equilibrium nature of active particles.\n:::\n\nVisually, this time-reversal asymmetry can be observed in trajectory data: forward trajectories show persistent motion along the instantaneous orientation, while time-reversed trajectories would appear to move persistently against their orientation—a scenario prohibited by the ABP dynamics. This persistence is also evident in the ballistic regime of the mean square displacement, which has no counterpart in equilibrium systems.\n\n### FDT Violation\n\nAs we saw in Lecture 2, the fluctuation-dissipation theorem (FDT) connects the spontaneous fluctuations in equilibrium systems to their response to external perturbations. For ABPs, this theorem is violated due to the self-propulsion term that injects energy at the microscopic level.\n\nThe violation of the FDT can be quantified by introducing an effective temperature:\n\n$$T_{\\text{eff}} = T\\left(1 + \\frac{v_0^2}{2D_tD_r}\\right)$$\n\nThis effective temperature is higher than the bath temperature, reflecting the enhanced fluctuations due to activity.\n\n\n### Taxonomy of Active Particle Models\n\nBesides the two active particle models there are a number of other ones capturing different aspects of active motion.\n\n\n| Model | Key Characteristics | Movement Mechanism | Biological/Synthetic Examples | Physical Limitations |\n|-------|---------------------|--------------------|--------------------|---------------------|\n| Run-and-Tumble Particles (RTPs) | Alternates between straight runs and random reorientations | Discrete reorientations at Poisson-distributed times | E. coli bacteria, Salmonella | Assumes instantaneous reorientations and ignores hydrodynamic interactions; real bacteria have finite tumbling durations and experience fluid resistance |\n| Active Brownian Particles (ABPs) | Persistent propulsion with continuous rotational diffusion | Continuous rotational diffusion combined with constant propulsion speed | Janus colloids, synthetic microswimmers | Neglects hydrodynamic interactions and assumes constant propulsion regardless of environmental conditions; real swimmers may adjust speed based on energy constraints |\n| Active Ornstein-Uhlenbeck Particles (AOUPs) | Self-propulsion with temporal correlations, colored noise | Velocity undergoes Ornstein-Uhlenbeck process with persistence time | Certain synthetic microswimmers, simplified model for biological cells | Lacks clear orientation-propulsion coupling present in real swimmers; statistical process may not accurately represent actual biological propulsion mechanisms |\n| Chiral Active Particles | Circular/helical trajectories due to intrinsic torque | Constant angular velocity combined with self-propulsion | Magnetotactic bacteria, sperm cells near surfaces | Assumes constant angular velocity and curvature radius; real organisms often modulate these parameters based on environmental cues and energetic constraints |\n\n## Swimming at Low Reynolds Number\n\nMicroorganisms and synthetic microswimmers propel themselves in a liquid environment generally described by the Navier-Stokes equation, which governs fluid motion by balancing inertial forces with pressure gradients, viscous forces, and external forces:\n\n$$\\rho\\left(\\frac{\\partial \\mathbf{v}}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\mathbf{v}\\right) = -\\nabla p + \\eta\\nabla^2\\mathbf{v} + \\mathbf{f}$$\n\nHere, $\\rho$ is fluid density, $\\mathbf{v}$ is velocity, $p$ is pressure, $\\eta$ is dynamic viscosity, and $\\mathbf{f}$ represents external force density. Through dimensional analysis, we can determine the relative importance of the inertial ($\\rho\\mathbf{v} \\cdot \\nabla \\mathbf{v}$) versus viscous ($\\eta\\nabla^2\\mathbf{v}$) terms. If we scale length by $L$, velocity by $V$, and time by $L/V$, the inertial term scales as $\\rho V^2/L$ while the viscous term scales as $\\eta V/L^2$. Their ratio yields the dimensionless Reynolds number:\n\n$$Re = \\frac{\\rho v L}{\\eta}$$\n\nwhere $\\rho$ is the fluid density, $v$ is the characteristic velocity, $L$ is the characteristic length scale, and $\\eta$ is the fluid viscosity.\n\nFor a swimming bacterium like E. coli:\n\n- $L \\approx 1 \\, \\mu\\text{m}$\n- $v \\approx 30 \\, \\mu\\text{m/s}$\n- $\\rho \\approx 10^3 \\, \\text{kg/m}^3$ (water)\n- $\\eta \\approx 10^{-3} \\, \\text{Pa} \\cdot \\text{s}$ (water)\n\nThis gives $Re \\approx 3 \\times 10^{-5}$, indicating that viscous forces overwhelmingly dominate inertial forces. This regime presents unique challenges for locomotion that are fundamentally different from our macroscopic experience.\n\n### The Scallop Theorem\n\nAt low Reynolds numbers, the inertial term in the Navier-Stokes equations can be dropped, leading to the simplified Stokes equations:\n\n$$\\eta \\nabla^2 \\mathbf{v} - \\nabla p = 0$$\n$$\\nabla \\cdot \\mathbf{v} = 0$$\n\nwhere $\\mathbf{v}$ is the fluid velocity and $p$ is the pressure. These equations are linear and time-independent, which leads to the \"scallop theorem\".\n\n:::{.callout-note}\n# The Scallop Theorem\n\nThe Scallop Theorem states that a microswimmer with a single degree of freedom cannot achieve net displacement in a Stokesian fluid (low Reynolds number). A scallop, which can only open and close its shell, represents such a mechanism with a single hinge. When the scallop opens slowly and closes rapidly in water, it generates thrust at the macroscale where inertia matters. However, at the microscale where viscous forces dominate, the time-reversibility of Stokes flow means the scallop would simply trace the same path backward and forward, resulting in no net movement regardless of how asymmetrically it times its opening and closing motions.\n\n\n\n::: {#fig-scallop}\n![](/assets/images/lecture03/Purcell’s_swimming_scallop_with_reciprocal_motion.png){width=70%}\n\nIllustration of the scallop theorem principle: a scallop-like mechanism with a single hinge can generate thrust at high Reynolds numbers (left) but produces no net motion at the microscale (right) where viscous forces dominate, as the motion is fully reversible. Source: [1] Yang, C., Liu, X., Song, X. & Zhang, L. Design and batch fabrication of anisotropic microparticles toward small-scale robots using microfluidics: recent advances. Lab a Chip 24, 4514–4535 (2024).\n:::\n:::\n\nThis theorem, formulated by Edward Purcell, can be understood as follows: if a swimmer changes its shape from A to B and then reverses this change from B to A along exactly the same path in configuration space, the net displacement will be zero. This is in stark contrast to swimming at high Reynolds numbers, where inertia allows for net displacement even with reciprocal motion.\n\n### Breaking Time-Reversibility\n\nTo achieve net displacement at low Reynolds numbers, a swimmer must break time-reversibility. This can be done in several ways:\n\n1. **Non-reciprocal deformation**: The swimmer changes shape in a way that is not simply the reverse of the previous motion. Examples include Purcell's three-link swimmer and the flexible oar.\n\n::: {#fig-amoeba}\n![](/assets/images/lecture03/amoaba.png){width=70%}\n\nAmoeboid movement represents a classic example of non-reciprocal deformation, where the organism extends pseudopodia (temporary projections of cytoplasm) in a coordinated sequence that cannot be simply reversed. This asymmetric reshaping of the cell body enables locomotion even at low Reynolds numbers by creating a non-time-reversible sequence of configurations.\n:::\n\n\n\n2. **Chiral propellers**: Rotating a chiral structure like a bacterial flagellum creates propulsion. The helical shape of the flagellum converts rotational motion into translational thrust.\n\n::: {#fig-flagellum}\n![](/assets/images/lecture03/Swimming-Bacillus-300x140.png){width=40%}\n\nThe helical structure of a bacterial flagellum allows it to convert rotational motion into translational thrust through a process known as the \"whirlpool effect.\" As the flagellum rotates, it creates a swirling motion in the surrounding fluid, which pushes the cell forward.\n:::\n\n\n\n3. **Multiple degrees of freedom**: Using two or more degrees of freedom with phase differences between them (like the motion of cilia) creates non-reciprocal motion.\n\n::: {#fig-purcell}\n![](/assets/images/lecture03/purcell_swimmer.png){width=60%}\n\nPurcell's three-link swimmer demonstrates how a simple articulated structure with two degrees of freedom (two hinges) can achieve net displacement at low Reynolds numbers. By executing a non-reciprocal sequence of shape changes—moving the links in a way that cannot be reversed by simply retracing the path—this minimal swimmer breaks time-reversibility and generates directed motion in a viscous environment.\n:::\n\n\n\n\n## From Swimming to Hydrodynamic Interactions\n\nWhen microorganisms swim at low Reynolds numbers, they don't just move themselves - they also generate flow fields in the surrounding fluid. These flow fields arise from the force-free swimming mechanisms we've explored and significantly influence how microswimmers interact with their environment and each other.\n\n### The Origin of Hydrodynamic Singularities in Swimming\n\nTo understand how swimming generates flow fields, we need to examine two fundamental types of elementary flow patterns in Stokes flow:\n\n1. **Source/sink dipoles**: These represent the displacement of fluid as a body moves through it. Consider a sphere moving through fluid - it pushes fluid ahead (source) and creates a region behind where fluid flows in (sink). These source dipoles:\n   - Decay rapidly with distance as $1/r^3$\n   - Contribute to the propulsion of the swimmer\n   - Result from the swimmer's shape changes and boundary motion\n\n   The flow field generated by a source dipole with dipole moment $\\mathbf{p}$ at a position $\\mathbf{r}$ relative to the dipole center is:\n\n   $$\\mathbf{u}_{\\text{dipole}}(\\mathbf{r}) = -\\frac{1}{4\\pi}\\nabla \\left(\\frac{\\mathbf{p} \\cdot \\mathbf{r}}{r^3}\\right) = \\frac{1}{4\\pi}\\left[\\frac{3(\\mathbf{p} \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\mathbf{p}}{r^3}\\right]$$\n\n   where $r = |\\mathbf{r}|$. This is analogous to the electric field of an electric dipole, with the $1/r^3$ decay characteristic of dipole fields.\n\n::: {#cell-fig-source-dipole .cell execution_count=6}\n``` {.python .cell-code code-fold=\"true\"}\n# Set up a grid\nx = np.linspace(-3, 3, 100)\ny = np.linspace(-3, 3, 100)\nX, Y = np.meshgrid(x, y)\n\n# Calculate R (distance from origin) for each point\nR = np.sqrt(X**2 + Y**2)\n\n# Define dipole moment vector (along x-axis)\np_x, p_y = 1.0, 0.0\n\n# Calculate dot product p·r\np_dot_r = p_x*X + p_y*Y\n\n# Set up arrays for velocity field components\nu = np.zeros_like(X)\nv = np.zeros_like(Y)\n\n# Apply the dipole equation at each point where R > 0\n# u = (1/4π)[(3(p·r)x/r^5) - (p_x/r^3)]\n# v = (1/4π)[(3(p·r)y/r^5) - (p_y/r^3)]\n\nmask = R > 0.2  # Avoid singularity at origin\n\nu[mask] = (1/(4*np.pi))*(3*p_dot_r[mask]*X[mask]/R[mask]**5 - p_x/R[mask]**3)\nv[mask] = (1/(4*np.pi))*(3*p_dot_r[mask]*Y[mask]/R[mask]**5 - p_y/R[mask]**3)\n\n# Create plot\nplt.figure(figsize=get_size(8, 8))\n\n# Plot streamlines\nplt.streamplot(X, Y, u, v, density=1, color='k', linewidth=1, arrowsize=0.5)\n\n# Add dipole location and moment direction\nplt.scatter(0, 0, color='red', s=50, label='Dipole location')\nplt.arrow(0, 0, p_x*0.5, p_y*0.5, width=0.05, head_width=0.15,\n          head_length=0.2, fc='red', ec='red', label='Dipole moment')\n\nplt.xlabel('x')\nplt.ylabel('y')\nplt.title('Source Dipole Flow Field')\nplt.axis('equal')\nplt.grid(True, linestyle='--', alpha=0.7)\nplt.xlim(-3, 3)\nplt.ylim(-3, 3)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Flow field generated by a source dipole with dipole moment $\\mathbf{p}$ pointing in the x-direction. The streamlines show the characteristic pattern of fluid being pushed away along the dipole axis and drawn in from the sides, with the flow strength decaying as $1/r^3$.](lecture03_files/figure-html/fig-source-dipole-output-1.png){#fig-source-dipole width=458 height=459}\n:::\n:::\n\n\n2. **Force dipoles**: Since microswimmers are force-free (no net external force), the thrust forces they generate must be balanced by drag forces, creating a force dipole configuration. A force dipole is generated by two equal and opposite point forces aligned parallel to the x-axis, either both pointing towards the origin (converging) or both pointing away from the origin (diverging). These force dipoles:\n   - Decay more slowly with distance as $1/r^2$\n   - Dominate the long-range hydrodynamic interactions\n   - Allow us to classify swimmers as either \"pushers\" (forces pointing away from the origin, like E. coli) or \"pullers\" (forces pointing towards the origin, like Chlamydomonas)\n\n   For a force dipole aligned along unit vector $\\mathbf{e}$, the flow field is:\n\n   $$\\mathbf{u}_{\\text{stresslet}}(\\mathbf{r}) = \\frac{S}{8\\pi\\eta}\\left[\\frac{3(\\mathbf{e}\\cdot\\mathbf{r})^2\\mathbf{r} - r^2\\mathbf{e}}{r^5}\\right]$$\n\n   where $S$ is the stresslet strength (dipole moment) and $\\eta$ is the fluid viscosity. The sign of $S$ determines the swimmer type: $S < 0$ for pushers and $S > 0$ for pullers. For a swimmer of size $a$ moving at speed $v_0$, we can estimate $S \\sim \\eta a^2 v_0$.\n\n   At large distances, this simplifies to:\n\n   $$\\mathbf{u}_{\\text{stresslet}}(\\mathbf{r}) \\approx \\frac{S}{8\\pi\\eta}\\frac{3(\\mathbf{e}\\cdot\\hat{\\mathbf{r}})^2-1}{r^2}\\hat{\\mathbf{r}} \\quad \\text{as } r \\to \\infty$$\n\n   where $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ is the direction vector.\n\n::: {#cell-fig-stresslet .cell execution_count=7}\n``` {.python .cell-code code-fold=\"true\"}\n# Create figure with two subplots for pusher and puller\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=get_size(12, 6))\n\n# Set up a grid\nx = np.linspace(-3, 3, 100)\ny = np.linspace(-3, 3, 100)\nX, Y = np.meshgrid(x, y)\n\n# Calculate R (distance from origin) for each point\nR = np.sqrt(X**2 + Y**2)\n\n# For both pusher and puller\nfor ax, S, title in zip([ax1, ax2], [-1.0, 1.0], [\"Puller (S < 0)\", \"Pusher (S > 0)\"]):\n    # Set up arrays for velocity field components\n    u = np.zeros_like(X)\n    v = np.zeros_like(Y)\n\n    # Avoid singularity at origin\n    mask = R > 0.2\n    eta = 1.0  # Normalize viscosity\n    r_sq = X[mask]**2 + Y[mask]**2\n\n    # x-component\n    u[mask] = (S/(8*np.pi*eta)) * (3*(X[mask]**2)*X[mask] - r_sq*X[mask])/R[mask]**5\n\n    # y-component\n    v[mask] = (S/(8*np.pi*eta)) * (3*(X[mask]**2)*Y[mask] - 0)/R[mask]**5\n\n    # Plot streamlines\n    ax.streamplot(X, Y, u, v, density=1.2, color='k', linewidth=0.5, arrowsize=0.5)\n\n    # Add force locations and arrows to visualize the dipole\n    if S < 0:  # Puller: forces pointing outward\n        ax.arrow(-0.4, 0, 0.3, 0, width=0.05, head_width=0.15,\n                head_length=0.2, fc='red', ec='red')\n        ax.arrow(0.4, 0, -0.3, 0, width=0.05, head_width=0.15,\n                head_length=0.2, fc='red', ec='red')\n        ax.scatter([-0.4, 0.4], [0, 0], color='red', s=50)\n    else:  # Puller: forces pointing inward\n        ax.arrow(-0.4, 0, -0.3, 0, width=0.05, head_width=0.15,\n                head_length=0.2, fc='red', ec='red')\n        ax.arrow(0.4, 0, 0.3, 0, width=0.05, head_width=0.15,\n                head_length=0.2, fc='red', ec='red')\n        ax.scatter([-0.4, 0.4], [0, 0], color='red', s=50)\n\n    ax.set_xlabel('x')\n    ax.set_ylabel('y')\n    ax.set_title(title)\n    ax.set_xlim(-3, 3)\n    ax.set_ylim(-3, 3)\n    ax.set_aspect('equal')\n    ax.grid(True, linestyle='--', alpha=0.7)\n\nplt.tight_layout()\nplt.show()\n\n```\n\n::: {.cell-output .cell-output-display}\n![Pusher Puller](lecture03_files/figure-html/fig-stresslet-output-1.png){#fig-stresslet width=688 height=365}\n:::\n:::\n\n\nIn the far field, the flow generated by a force dipole (pusher, S > 0) at large distances from the swimmer exhibits a dominant $1/r^2$ decay pattern. Fluid is pulled in from the sides and pushed away along the swimming direction.\n\n::: {#cell-fig-farfield .cell execution_count=8}\n``` {.python .cell-code code-fold=\"true\"}\n# Set up a grid for far-field visualization (larger domain)\nx_far = np.linspace(-10, 10, 100)\ny_far = np.linspace(-10, 10, 100)\nX_far, Y_far = np.meshgrid(x_far, y_far)\n\n# Calculate R (distance from origin) for each point\nR_far = np.sqrt(X_far**2 + Y_far**2)\n\n# Set up arrays for velocity field components\nu_far = np.zeros_like(X_far)\nv_far = np.zeros_like(Y_far)\n\n# Parameters\nS = 1.0  # Positive for pusher\neta = 1.0  # Normalized viscosity\ne_x, e_y = 1.0, 0.0  # Unit vector along x-axis\n\n# Avoid singularity at origin\nmask_far = R_far > 0.5\n\n# Compute unit radial vectors\nr_hat_x = X_far[mask_far] / R_far[mask_far]\nr_hat_y = Y_far[mask_far] / R_far[mask_far]\n\n# Compute e·r̂\ne_dot_r_hat = e_x*r_hat_x + e_y*r_hat_y\n\n# Far-field approximation: u ≈ (S/8πη)[(3(e·r̂)² - 1)/r²]r̂\n# Calculate the scalar coefficient\ncoef = (S/(8*np.pi*eta)) * (3*e_dot_r_hat**2 - 1) / R_far[mask_far]**2\n\n# Apply to get velocity components\nu_far[mask_far] = coef * r_hat_x\nv_far[mask_far] = coef * r_hat_y\n\n# Create plot\nplt.figure(figsize=get_size(10, 8))\n\n# Plot streamlines for far-field approximation\nplt.streamplot(X_far, Y_far, u_far, v_far, density=1.0, color='k',\n               linewidth=0.8, arrowsize=0.8)\n\n\n# Add swimming direction indication\nplt.arrow(0, 0, 2, 0, width=0.2, head_width=0.6,\n          head_length=0.8, fc='blue', ec='blue', alpha=0.7)\nplt.scatter(0, 0, color='blue', s=80, alpha=0.7, label='Swimmer')\n\nplt.xlabel('x')\nplt.ylabel('y')\nplt.title('Far-field Force Dipole Flow (Pusher)')\nplt.axis('square')\nplt.xlim(-10, 10)\nplt.ylim(-10, 10)\n\n# Add a circle to indicate the near-field region\ncircle = plt.Circle((0, 0), 2, fill=False, color='red', linestyle='--', alpha=0.7)\nplt.gca().add_patch(circle)\nplt.text(2.2, 0.5, 'Near-field', color='red', alpha=0.7)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Far-field approximation of the flow generated by a force dipole (pusher, S > 0) at large distances from the swimmer. The streamlines illustrate how the dominant $1/r^2$ decay pattern emerges, with fluid being pulled in from the sides and pushed away along the swimming direction.](lecture03_files/figure-html/fig-farfield-output-1.png){#fig-farfield width=487 height=459}\n:::\n:::\n\n\nThis distinction has important physical consequences: source dipoles enable self-propulsion but decay rapidly, while force dipoles dominate the long-range interactions between swimmers. These flow fields can be derived from the fundamental solution of Stokes flow (the Oseen tensor):\n\n$$G_{ij}(\\mathbf{r}) = \\frac{1}{8\\pi\\eta}\\left(\\frac{\\delta_{ij}}{r} + \\frac{r_i r_j}{r^3}\\right)$$\n\nwhich gives the velocity field at position $\\mathbf{r}$ due to a point force at the origin.\n\n",
    "supporting": [
      "lecture03_files"
    ],
    "filters": [],
    "includes": {}
  }
}